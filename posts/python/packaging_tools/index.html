<!doctype html><html><head><title>An unbiased evaluation of environment management and packaging tools</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="ie=edge"><link rel=stylesheet href=/css/bootstrap.min.css><link rel=stylesheet href=/css/layouts/main.css><link rel=stylesheet href=/css/style.css><link rel=stylesheet href=/css/navigators/navbar.css><link href="https://fonts.googleapis.com/css2?family=Muli:wght@300;400;500;600" rel=stylesheet><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/all.min.css><link rel=icon type=image/png href=/images/author/image_al_hu6aa485cfd64a98f54b411e3a0324b396_178285_42x0_resize_q75_box.jpg><link rel=stylesheet href=/css/style.css><meta name=description content="An unbiased evaluation of environment management and packaging tools"><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/styles/atom-one-dark.min.css><link rel=stylesheet href=/css/layouts/single.css><link rel=stylesheet href=/css/navigators/sidebar.css></head><body data-spy=scroll data-target=#TableOfContents data-offset=80><div class="container-fluid bg-dimmed wrapper"><nav class="navbar navbar-expand-xl top-navbar final-navbar shadow"><div class=container><button class="navbar-toggler navbar-light" id=sidebar-toggler type=button onclick=toggleSidebar()>
<span class=navbar-toggler-icon></span></button>
<a class=navbar-brand href=/><img src=/images/author/image_al_hu6aa485cfd64a98f54b411e3a0324b396_178285_42x0_resize_q75_box.jpg>Anna-Lena Popkes</a>
<button class="navbar-toggler navbar-light" id=toc-toggler type=button onclick=toggleTOC()>
<span class=navbar-toggler-icon></span></button><div class="collapse navbar-collapse lang-selector" id=top-nav-items><ul class="navbar-nav ml-auto"></ul></div></div><img src=/images/author/image_al_hu6aa485cfd64a98f54b411e3a0324b396_178285_42x0_resize_q75_box.jpg class=d-none id=main-logo>
<img src=/images/author/image_al_hu6aa485cfd64a98f54b411e3a0324b396_178285_42x0_resize_q75_box.jpg class=d-none id=inverted-logo></nav><section class=sidebar-section id=sidebar-section><div class=sidebar-holder><div class=sidebar id=sidebar><input type=text placeholder=Search data-search id=search-box><div class=sidebar-tree><ul class=tree id=tree><li id=list-heading><a href=/posts data-filter=all>Posts</a></li><div class=subtree><li><a href=/posts/news/>Personal news</a></li><li><a href=/posts/my_path_to_ml/>My path to machine learning</a></li><li><i class="fas fa-plus-circle"></i><a href=/posts/books/>Books</a><ul><li><a href=/posts/books/reading_list/>Personal reading List</a></li><li><a href=/posts/books/deep_work/>Deep work</a></li></ul></li><li><i class="fas fa-plus-circle"></i><a href=/posts/machine_learning/>Machine Learning</a><ul><li><a href=/posts/machine_learning/bayesian_linear_regression/>Bayesian linear regression</a></li><li><a href=/posts/machine_learning/bayesian_linear_regression_2/>Bayesian linear regression 2</a></li><li><a href=/posts/machine_learning/kl_divergence/>KL Divergence</a></li><li><a href=/posts/machine_learning/principal_component_analysis/>Principal component analysis (PCA)</a></li><li><a href=/posts/machine_learning/support_vector_machines/>Support vector machines</a></li><li><a href=/posts/machine_learning/variational_inference/>Variational Inference</a></li></ul></li><li><i class="fas fa-minus-circle"></i><a class=active href=/posts/python/>Python</a><ul class=active><li><a href=/posts/python/mocking/>Mocking</a></li><li><a class=active href=/posts/python/packaging_tools/>Packaging tools</a></li><li><i class="fas fa-plus-circle"></i><a href=/posts/python/magical_universe/>Magical Universe</a><ul><li><a href=/posts/python/magical_universe/day_1_start/>Start</a></li><li><a href=/posts/python/magical_universe/day_1_magical_universe/>The Tales of Castle Kilmere</a></li><li><a href=/posts/python/magical_universe/day_1_first_post_oop/>Object-oriented programming</a></li><li><a href=/posts/python/magical_universe/day_2_types_of_methods/>Types of methods</a></li><li><a href=/posts/python/magical_universe/day_3_type_annotations/>Type annotations</a></li><li><a href=/posts/python/magical_universe/day_4_to_string_conversion/>To-string conversion</a></li><li><a href=/posts/python/magical_universe/day_5_decorators/>Decorators</a></li><li><a href=/posts/python/magical_universe/day_6_properties/>Properties</a></li><li><a href=/posts/python/magical_universe/day_7_underscore_patterns/>Underscore patterns</a></li><li><a href=/posts/python/magical_universe/day_8_extending_universe/>Extending the universe</a></li><li><a href=/posts/python/magical_universe/day_9_duck_typing/>Duck Typing</a></li><li><a href=/posts/python/magical_universe/day_10_11_namedtuples/>Namedtuples</a></li><li><a href=/posts/python/magical_universe/day_12_to_15_abcs/>Abstract Base Classes</a></li><li><a href=/posts/python/magical_universe/day_16_to_18_data_classes/>Data classes</a></li><li><a href=/posts/python/magical_universe/day_19_immutable_data_classes/>Immutable data classes</a></li><li><a href=/posts/python/magical_universe/day_20_decorators_in_classes/>Decorators in classes</a></li><li><a href=/posts/python/magical_universe/day_21_if_main/>if __name__ == "__main__"</a></li><li><a href=/posts/python/magical_universe/day_22_to_24_context_managers/>Context managers</a></li><li><a href=/posts/python/magical_universe/day_25_to_28_pytest/>Testing with pytest</a></li><li><a href=/posts/python/magical_universe/day_29_to_31_iterators/>Iterators</a></li><li><a href=/posts/python/magical_universe/day_34_multisets/>Multisets</a></li><li><a href=/posts/python/magical_universe/day_37_extending_universe/>Extending the universe II</a></li><li><a href=/posts/python/magical_universe/day_43_to_45_exception_classes/>Exception classes</a></li><li><a href=/posts/python/magical_universe/day_46_functools_wraps/>functools.wraps</a></li><li><a href=/posts/python/magical_universe/day_47_to_48_defaultdict/>Defaultdict</a></li><li><a href=/posts/python/magical_universe/day_49_to_50_config_files/>Config files</a></li><li><a href=/posts/python/magical_universe/2018-09-16-blog-post-day-51/>Wrap up</a></li></ul></li></ul></li><li><i class="fas fa-plus-circle"></i><a href=/posts/software_engineering/>Software Engineering</a><ul><li><a href=/posts/software_engineering/containers/>Intro to containers</a></li><li><a href=/posts/software_engineering/docker/>Intro to Docker</a></li><li><a href=/posts/software_engineering/virtual_machines/>Intro to virtual machines</a></li></ul></li></div></ul></div></div></div></section><section class=content-section id=content-section><div class=content><div class="container p-0 read-area"><div class="hero-area col-sm-12" id=hero-area style=background-image:url(https://alpopkes.com/images/default-hero.jpg)></div><div class=page-content><div class="author-profile ml-auto align-self-lg-center"><img class=rounded-circle src=/images/author/image_al.jpg><h5 class=author-name>Anna-Lena Popkes</h5><p>August 21, 2023</p></div><div class=title><h1>An unbiased evaluation of environment management and packaging tools</h1></div><div class=post-content id=post-content><p><strong>Topics:</strong> An unbiased evaluation of environment management and packaging tools</p><h2 id=motivation>Motivation</h2><p>When I started with Python and created my first package I was confused. Creating and managing a package seemed much harder than I expected. In addition, multiple tools existed and I wasn&rsquo;t sure which one to use. I&rsquo;m sure most of you had the very same problem in the past. Python has a zillion tools to manage virtual environments and create packages and it can be hard (or almost impossible) to understand which one fits your needs. Several talks and blog post on the topic exist, but none of them gives a complete overview or evaluates the tools in a structured fasion. This is what this post is about. I want to give you a truly unbiased evaluation of existing packaging and environment management tools. In case you&rsquo;d rather watch a talk, take a look at the recording of <a href="https://www.youtube.com/watch?v=MsJjzVIVs6M">PyCon DE 2023</a>.</p><h2 id=categorization>Categorization</h2><p>For the purpose of the talk I identified five main categories that are important:</p><ul><li>Python version management</li><li>Environment management (which is mostly concerned with virtual environments)</li><li>Package management</li><li>Package building</li><li>Package publishing</li></ul><p>As you can see in the figure below, lots of tools exist. Some can do a single thing (i.e. they are single-purpose), others can perform multiple tasks (hence I call them multi-puprose tools).</p><img src=/posts/python/figures/venn_diagram.png width=50% class=center><p>Let&rsquo;s walk through the categories keeping a developers perspective in mind. Let&rsquo;s say you are working on a personal project alongside your work projects. At work you&rsquo;re using Python 3.7 whereas your personal project should be using the newest Python version (currently 3.11). In other words: you want to be able to install different Python versions and switch between them. That&rsquo;s what our first category, <strong>Python version management</strong> is about. Within your projects you are using other packages (e.g. <code>pandas</code> or <code>sklearn</code> for data science). These are dependencies of your project that you have to install and manage (e.g. upgrade when new versions are released). This is what <strong>package management</strong> is about. Because different projects might require different versions of the same package you need to create (and manage) virtual environments to avoid dependency conflicts. Tools for this are collected in the category <strong>environment management</strong>. Most tools use virtual environments, but some use another concept called &ldquo;local packages&rdquo; which we will look at later. Once your code is in a proper state you might want to share it with fellow developers. For this you first have to build your package (<strong>package building</strong>) before you can publish it to PyPi or another index (<strong>package publishing</strong>).</p><p>In the following we will look at each category in more detail, including a short definition, motivation and the available tools. I will present some single-purpose tools in more detail and several multi-purpose tools in a separate section at the end. Let&rsquo;s get started with the first category: Python version management.</p><h2 id=python-version-managment>Python version managment</h2><h3 id=definition>Definition</h3><p>A tool that can perform Python version management allows you to install Python versions and switch between the versions easily.</p><h3 id=motivation-1>Motivation</h3><p>Why would we want to use different Python versions? There are several reasons. For example, you might be working of several projects where each projects requires a different Python version. Or you might develop a project that supports several Python versions and you want to test all of them. Besides that it can be nice to check out what the newest Python version has to offer, or test a pre-release version of Python for bugs.</p><h3 id=tools>Tools</h3><img src=/posts/python/figures/python_version_management.png width=50% class=center><h4 id=pyenv>pyenv</h4><p>Python has one single-purpose tool that lets you install and manage Python versions: <code>pyenv</code>! Pyenv is easy to use. The most important commands are the following:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># Install specific Python version</span>
</span></span><span style=display:flex><span>pyenv install 3.10.4
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Switch between Python versions</span>
</span></span><span style=display:flex><span>pyenv shell &lt;version&gt;
</span></span><span style=display:flex><span>pyenv local &lt;version&gt;
</span></span><span style=display:flex><span>pyenv global &lt;version&gt;
</span></span></code></pre></div><h2 id=virtual-environment-management>(Virtual) environment management</h2><h3 id=definition-1>Definition</h3><p>A tool that can perform enviornment management allows you to create and manage (virtual) environments.</p><h3 id=motivation-2>Motivation</h3><p>Why do we want to use environments in the first place? As mentioned in the beginning, projects have specific requirements (i.e. they depend on other packages). It&rsquo;s often the case that different projects require different versions of the same package. This can cause depenency conflicts. In addition, problems can occur when using <code>pip install</code> to install a package because the package is placed with your system-wide Python installation (e.g. system pollution). Some of these problems can be solved by using the <code>--user</code> flag. However, this option might not be known to everyone, especially beginners. Python has two main single-purpose tools that can be used to manage virtual envs: <code>venv</code> and <code>virtualenv</code>. Let&rsquo;s look at both of them in more detail.</p><h3 id=tools-1>Tools</h3><img src=/posts/python/figures/env_management.png width=50% class=center><h3 id=venv>venv</h3><p><code>venv</code> is the built-in Python package for creating virtual environments. This means that it is shipped with Python and does not have to be installed by the user. The most important commands are the following:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># Create env</span>
</span></span><span style=display:flex><span>python3 -m venv &lt;env_name&gt;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Activate env </span>
</span></span><span style=display:flex><span>source &lt;env_name&gt;/bin/activate
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Deactivate env</span>
</span></span><span style=display:flex><span>deactivate
</span></span></code></pre></div><h3 id=virtualenv>virtualenv</h3><p><code>virtualenv</code> tries to improve <code>venv</code>. It offers more features than <code>venv</code> and is faster and more powerful. The most important commands are similar to the ones of <code>venv</code>, only creating a new environment is cleaner:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># Create env</span>
</span></span><span style=display:flex><span>virtualenv &lt;env_name&gt;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Activate env </span>
</span></span><span style=display:flex><span>source &lt;env_name&gt;/bin/activate
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Deactivate env</span>
</span></span><span style=display:flex><span>deactivate
</span></span></code></pre></div><h2 id=recap-i---pyprojecttoml>Recap I - <code>pyproject.toml</code></h2><p>Before we can talk about packaging I want to make sure that you are aware of the most important file for packaging: <code>pyproject.toml</code>.</p><p>Packaging in Python has come a long way. Until PEP 518 <code>setup.py</code> files where used for packaging, using <code>setuptools</code> as a build tool. PEP 518 introduced the usage of a <code>pyproject.toml</code> file. So right now, when creating a package we need a pyproject.toml file. It is used to define the settings of a project, set metadata and lots of other things. If you would like to see an example check out the <a href=https://github.com/pandas-dev/pandas/blob/main/pyproject.toml><code>pyproject.toml</code> file of the pandas library</a>.</p><p>With this knowledge we can go on at take a look at package management.</p><h2 id=package-management>Package management</h2><h3 id=definition-2>Definition</h3><p>A tool that can perform package management is able to download and install libraries and their dependencies.</p><h3 id=motivation-3>Motivation</h3><ul><li>Packages allow us to define a hierarchy of modules</li><li>Modules can be accessed easily using the dot-syntax</li><li>Code can easily be shared with other developers</li><li>Project dependencies are bundled in <code>pyproject.toml</code></li></ul><p>Why do we care about packages? Packages allow us to define a hierarchy of modules and to access modules easily using the dot-syntax (<code>from package.module import my_function</code>). In addition, they make it easy to share code with other developers. Since each package as a <code>pyproject.toml</code> file which defines its dependencies, other developers don’t have to install the required packages separately but can simply install the package from its <code>pyproject.toml</code> file.</p><h3 id=tools-2>Tools</h3><img src=/posts/python/figures/package_management.png width=50% class=center><h4 id=pip>pip</h4><p>The standard package manager for Python is <code>pip</code>. It&rsquo;s shipped with Python and allows you to install packages from PyPI and other indexes. The main command (probably one of the first commands a Python developer learns) is <code>pip install &lt;package_name></code>.</p><h2 id=recap-ii---lock-file>Recap II - lock file</h2><p>Before we go on to the multi-purpose tools, there is one more file that&rsquo;s important for packaging: the lock file. While <code>pyproject.toml</code> contains abstract dependencies, the lock file contains concrete dependencies. It records exact versions of all dependencies installed for a project. This enables reproducability of projects across multiple platforms. If you have never seen a lock file before, take a look at <a href=https://github.com/python-poetry/poetry/blob/master/poetry.lock>this one from <code>poetry</code></a>:</p><img src=/posts/python/figures/poetry_lock.png width=50% class=center><h2 id=multi-purpose-tools>Multi-purpose tools</h2><h3 id=pipenv>Pipenv</h3><img src=/posts/python/figures/pipenv.png width=50% class=center><p>As the name suggests, <a href=https://pipenv.pypa.io/en/latest/><code>pipenv</code></a> combines <code>pip</code> and <code>virtualenv</code>. It allows you to perform virtual environment management and package managementby introducing two additional files:</p><ul><li><code>Pipfile</code></li><li><code>Pipfile.lock</code></li></ul><p><code>Pipfile</code> is a TOML file (similar to <code>pyproject.toml</code>) used to define project dependencies. It is managed by the developer when she invokes pipenv commands (like <code>pipenv install</code>). <code>Pipfile.lock</code> allows for deterministic builds. It eliminates the need for a <code>requirements.txt</code> file and is managed automatically through locking actions .</p><p>The most important <code>pipenv</code> commands are:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># Install package</span>
</span></span><span style=display:flex><span>pipenv install &lt;package_name&gt;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Run Python script within virtual env</span>
</span></span><span style=display:flex><span>pipenv run &lt;script_name.py&gt;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Activate virtual env</span>
</span></span><span style=display:flex><span>pipenv shell
</span></span></code></pre></div><h3 id=conda>Conda</h3><img src=/posts/python/figures/conda.png width=50% class=center><p>Conda is a general-purpose package management system. That means that it&rsquo;s not limited to Python packages. Conda is a huge tool with lots of capabilities. Lot&rsquo;s of tutorials and blog posts exist (for example <a href=https://conda.io/projects/conda/en/latest/user-guide/getting-started.html#managing-python>the official one</a>) so I won&rsquo;t go into more detail here.</p><h3 id=feature-evaluation>Feature evaluation</h3><p>Last but not least we will take a look at multi-purpose tools for packaging. I promised an unbiased evaluation. For this purpose I created a list of features that are important when comparing the different tools. The features are the following:</p><table><thead><tr><th></th><th></th></tr></thead><tbody><tr><td>Manages dependencies</td><td>?</td></tr><tr><td>Resolves/locks dependencies</td><td>?</td></tr><tr><td>Clean build/publish flow</td><td>?</td></tr><tr><td>Allows to use plugins</td><td>?</td></tr><tr><td>Supports PEP 660 (editable installs)</td><td>?</td></tr><tr><td>Supports PEP 621 (project metadata)</td><td>?</td></tr></tbody></table><p>Regarding the two PEPs: Python has a lot of open and closed PEPs on packaging. For a full overview take a look at <a href=https://peps.python.org/topic/packaging/>this page</a>. I only included PEP 660 and PEP 621 for specific reasons:</p><ul><li><a href=https://peps.python.org/pep-0660/>PEP 660</a> is about editable installs for pyproject.toml based builds. When you install a package using <code>pip</code> you have the option to install it in editable mode using <code>pip install -e package_name</code>. This is an important features to have when you are developing a package and want your changes to be directly reflected in your environment.</li><li><a href=https://peps.python.org/pep-0621/>PEP 621</a> specifies how to write a project’s core metadata in a pyproject.toml file. I added it because one package (spoiler: it&rsquo;s <code>poetry</code>) currently does not support this PEP but uses its own way for declaring metadata.</li></ul><h3 id=flit>Flit</h3><p><a href=https://flit.pypa.io/en/stable/>Flit</a> tries to create a simple way to put Python packages and modules on PyPI. It has a very specific use case: it&rsquo;s meant to be used for packaging pure Python packages (that is, packages without a build step). It doesn&rsquo;t care about any of the other tasks (Python version management, etc.). This is also reflected in the feature evaluation below.</p><img src=/posts/python/figures/flit.png width=50% class=center><h4 id=flit---capabilities>Flit - Capabilities</h4><ul><li>Python version management: ❌</li><li>Package management: ❌</li><li>Environment management: ❌</li><li>Building a package: ✅</li><li>Publishing a package: ✅</li></ul><h4 id=flit---feature-evaluation>Flit - Feature evaluation</h4><table><thead><tr><th></th><th></th></tr></thead><tbody><tr><td>Manages dependencies</td><td>❌</td></tr><tr><td>Resolves/locks dependencies</td><td>❌</td></tr><tr><td>Clean build/publish flow</td><td>✅</td></tr><tr><td>Allows to use plugins</td><td>❌</td></tr><tr><td>Supports PEP 660 (editable installs)</td><td>✅</td></tr><tr><td>Supports PEP 621 (project metadata)</td><td>✅</td></tr></tbody></table><h4 id=flit---main-commands>Flit - Main commands</h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># Create new pyproject.toml</span>
</span></span><span style=display:flex><span>flit init
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Build and publish </span>
</span></span><span style=display:flex><span>flit publish
</span></span></code></pre></div><h3 id=poetry>Poetry</h3><p><a href=https://python-poetry.org/>Poetry</a> is a well known tool in the packaging world. As visible in the Venn diagram it can do everything except for Python version management. Taking a look at the feature evaluation below you will see than Poetry does <strong>not</strong> support PEP 621. There has been an open issue about this on Github for about 1.5 years, but it hasn&rsquo;t been integrated into the main code base (yet).</p><img src=/posts/python/figures/poetry.png width=50% class=center><h4 id=poetry---capabilities>Poetry - Capabilities</h4><ul><li>Python version management: ❌</li><li>Package management: ✅</li><li>Environment management: ✅</li><li>Building a package: ✅</li><li>Publishing a package: ✅</li></ul><h4 id=poetry---feature-evaluation>Poetry - Feature evaluation</h4><table><thead><tr><th></th><th></th></tr></thead><tbody><tr><td>Manages dependencies</td><td>✅</td></tr><tr><td>Resolves/locks dependencies</td><td>✅</td></tr><tr><td>Clean build/publish flow</td><td>✅</td></tr><tr><td>Allows to use plugins</td><td>✅</td></tr><tr><td>Supports PEP 660 (editable installs)</td><td>✅</td></tr><tr><td>Supports PEP 621 (project metadata)</td><td>❌</td></tr></tbody></table><h4 id=poetry---main-commands>Poetry - Main commands</h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># Create directory structure and pyproject.toml</span>
</span></span><span style=display:flex><span>poetry new &lt;project_name&gt;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Create pyproject.toml interactively</span>
</span></span><span style=display:flex><span>poetry init
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Install package from pyproject.toml</span>
</span></span><span style=display:flex><span>poetry install
</span></span></code></pre></div><h4 id=poetry---dependency-management>Poetry - Dependency management</h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># Add dependency</span>
</span></span><span style=display:flex><span>poetry add &lt;package_name&gt;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Display all dependencies</span>
</span></span><span style=display:flex><span>poetry show --tree
</span></span></code></pre></div><h4 id=poetry---running-code>Poetry - Running code</h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># Activate virtual env</span>
</span></span><span style=display:flex><span>poetry shell
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Run script within virtual env</span>
</span></span><span style=display:flex><span>poetry run python &lt;script_name.py&gt;
</span></span></code></pre></div><h4 id=poetry---lock-file>Poetry - Lock file</h4><p>When installing a package for the first time, Poetry simply resolves all dependencies listed in your <code>pyproject.toml</code> file and downloads the latest version of the packages.Once Poetry has finished installing, it writes all the packages and their exact versions that it downloaded to a <code>poetry.lock</code> file, locking the project to those specific versions. It&rsquo;s recommended to commit the lock file to your project repo so that all people working on the project are locked to the same versions of dependencies. To update your dependencies to the latest versions, use the <code>poetry update</code> command.</p><h2 id=poetry---buildpublish-flow>Poetry - Build/publish flow</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># Package code (creates `.tar.gz` and `.whl` files)</span>
</span></span><span style=display:flex><span>poetry build
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Publish to PyPi</span>
</span></span><span style=display:flex><span>poetry publish 
</span></span></code></pre></div><h3 id=pdm>PDM</h3><p><a href=https://pdm.fming.dev/latest/>PDM</a> is a relatively new package and dependency manager (started in 2019) that is strongly inspired by Poetry and PyFlow. You will notice that I&rsquo;m not talking about PyFlow in this article. That&rsquo;s because PyFlow is not actively developed anymore - a must in the quickly evolving landscape of packaging. As visible in the Venn diagram, PDM sits right next to Poetry. That means that it can do everything except for Python version management. Being a new(er) tool, PDM requires Python 3.7 or higher. Another difference to other tools is that PDM allows users to choose a build backend. PDM is the only tool (apart from PyFlow) that implements <a href=https://peps.python.org/pep-0582/>PEP 582</a> on local packages, an alternative way of implementing environment management. Note that this PEP was recently rejected.</p><p>The main commands of PDM are similar to Poetry. However, less commands exist. For example, there is no <code>pdm shell</code> or <code>pdm new</code> at the moment.</p><img src=/posts/python/figures/pdm.png width=50% class=center><h4 id=pdm---capabilities>PDM - Capabilities</h4><ul><li>Python version management: ❌</li><li>Package management: ✅</li><li>Environment management: ✅</li><li>Building a package: ✅</li><li>Publishing a package: ✅</li></ul><h4 id=pdm---feature-evaluation>PDM - Feature evaluation</h4><table><thead><tr><th></th><th></th></tr></thead><tbody><tr><td>Manages dependencies</td><td>✅</td></tr><tr><td>Resolves/locks dependencies</td><td>✅</td></tr><tr><td>Clean build/publish flow</td><td>✅</td></tr><tr><td>Allows to use plugins</td><td>✅</td></tr><tr><td>Supports PEP 660 (editable installs)</td><td>✅</td></tr><tr><td>Supports PEP 621 (project metadata)</td><td>✅</td></tr></tbody></table><h4 id=pdm---main-commands>PDM - Main commands</h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># Create pyproject.toml interactively</span>
</span></span><span style=display:flex><span>pdm init
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Install package from pyproject.toml</span>
</span></span><span style=display:flex><span>pdm install
</span></span></code></pre></div><h4 id=pdm---dependency-management>PDM - Dependency management</h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># Add dependency</span>
</span></span><span style=display:flex><span>pdm add &lt;package_name&gt;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Display all dependencies</span>
</span></span><span style=display:flex><span>pdm list --graph
</span></span></code></pre></div><h4 id=pdm---running-code>PDM - Running code</h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># No pdm shell command </span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Run script within env</span>
</span></span><span style=display:flex><span>pdm run python &lt;script_name.py&gt;
</span></span></code></pre></div><h4 id=pdm---lock-file>PDM - Lock file</h4><p>The locking functionality of PDM is similar to Poetry. When installing a package for the first time, PDM resolves all dependencies listed in your <code>pyproject.toml</code> file and downloads the latest version of the packages. Once PDM has finished installing, it writes all the packages and their exact versions that it downloaded to a <code>pdm.lock</code> file, locking the project to those specific versions. It&rsquo;s recommended to commit the lock file to your project repo so that all people working on the project are locked to the same versions of dependencies. To update your dependencies to the latest versions, use the <code>pdm update</code> command.</p><h4 id=buildpublish-flow>Build/publish flow</h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># Package code (creates `.tar.gz` and `.whl` files)</span>
</span></span><span style=display:flex><span>pdm build
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Publish to PyPi</span>
</span></span><span style=display:flex><span>pdm publish 
</span></span></code></pre></div><h3 id=hatch>Hatch</h3><img src=/posts/python/figures/hatch.png width=50% class=center><h4 id=hatch---capabilities>Hatch - Capabilities</h4><ul><li>Python version management: ❌</li><li>Package management: ❌</li><li>Environment management: ✅</li><li>Building a package: ✅</li><li>Publishing a package: ✅</li></ul><h4 id=hatch---feature-evaluation>Hatch - Feature evaluation</h4><table><thead><tr><th></th><th></th></tr></thead><tbody><tr><td>Manages dependencies</td><td>❌</td></tr><tr><td>Resolves/locks dependencies</td><td>❌</td></tr><tr><td>Clean build/publish flow</td><td>✅</td></tr><tr><td>Allows to use plugins</td><td>✅</td></tr><tr><td>Supports PEP 660 (editable installs)</td><td>✅</td></tr><tr><td>Supports PEP 621 (project metadata)</td><td>✅</td></tr></tbody></table><h4 id=hatch---creating-a-new-project>Hatch - Creating a new project</h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># Create directory structure and pyproject.toml</span>
</span></span><span style=display:flex><span>hatch new &lt;project_name&gt;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Interactive mode</span>
</span></span><span style=display:flex><span>hatch new -i &lt;project_name&gt;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Initialize existing project / create pyproject.toml</span>
</span></span><span style=display:flex><span>hatch new --init
</span></span></code></pre></div><h4 id=hatch---dependency-management>Hatch - Dependency management</h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#75715e># Packages are added manually to pyproject.toml</span>
</span></span><span style=display:flex><span>hatch add <span style=color:#f92672>&lt;</span>package_name<span style=color:#f92672>&gt;</span> <span style=color:#75715e># This command doesn&#39;t exist!</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Display dependencies</span>
</span></span><span style=display:flex><span>hatch dep show table
</span></span></code></pre></div><h4 id=hatch---running-code>Hatch - Running code</h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># Activate virtual env</span>
</span></span><span style=display:flex><span>hatch shell
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Run script within virtual env</span>
</span></span><span style=display:flex><span>hatch run python &lt;script_name.py&gt;
</span></span></code></pre></div><h4 id=hatch---buildpublish-flow>Hatch - Build/publish flow</h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># Package code (creates `.tar.gz` and `.whl` files)</span>
</span></span><span style=display:flex><span>hatch build
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Publish to PyPi</span>
</span></span><span style=display:flex><span>hatch publish 
</span></span></code></pre></div><h4 id=hatch---declarative-environment-management>Hatch - Declarative environment management</h4><ul><li>Environments can be configured within <code>pyproject.toml</code></li><li>We can define scripts for an environment</li><li>Example use case: <a href=https://hatch.pypa.io/1.1/config/environment/#scripts>code formatting</a></li></ul><h3 id=rye>Rye</h3><img src=/posts/python/figures/rye.png width=50% class=center><h4 id=rye---capabilities>Rye - Capabilities</h4><ul><li>Python version management: ✅</li><li>Package management: ✅</li><li>Environment management: ✅</li><li>Building a package: ✅</li><li>Publishing a package: ✅</li></ul><h4 id=rye-1>Rye</h4><ul><li>Very new (first release May 2023)</li><li>Inspired by rustup and cargo from Rust</li><li>Written in Rust</li></ul><h4 id=rye---feature-evaluation>Rye - Feature evaluation</h4><table><thead><tr><th></th><th></th></tr></thead><tbody><tr><td>Manages dependencies</td><td>✅</td></tr><tr><td>Resolves/locks dependencies</td><td>✅</td></tr><tr><td>Clean build/publish flow</td><td>✅</td></tr><tr><td>Allows to use plugins</td><td>❌</td></tr><tr><td>Supports PEP 660 (editable installs)</td><td>✅</td></tr><tr><td>Supports PEP 621 (project metadata)</td><td>✅</td></tr></tbody></table><h4 id=rye---creating-a-new-project>Rye - Creating a new project</h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># Create directory structure and pyproject.toml</span>
</span></span><span style=display:flex><span>rye init &lt;project_name&gt;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Pin a Python version</span>
</span></span><span style=display:flex><span>rye pin 3.10
</span></span></code></pre></div><h4 id=rye---dependency-management>Rye - Dependency management</h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#75715e># Add dependency - this does not install the package!</span>
</span></span><span style=display:flex><span>rye add <span style=color:#f92672>&lt;</span>package_name<span style=color:#f92672>&gt;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Synchronize virtual envs, lock file, etc.</span>
</span></span><span style=display:flex><span><span style=color:#75715e># This install packages and Python versions</span>
</span></span><span style=display:flex><span>rye sync
</span></span></code></pre></div><h4 id=rye---running-code>Rye - Running code</h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># Activate virtual env</span>
</span></span><span style=display:flex><span>rye shell
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Run script within virtual env</span>
</span></span><span style=display:flex><span>rye run python &lt;script_name.py&gt;
</span></span></code></pre></div><h4 id=rye---buildpublish-flow>Rye - Build/publish flow</h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># Package code (creates `.tar.gz` and `.whl` files)</span>
</span></span><span style=display:flex><span>rye build
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Publish to PyPi</span>
</span></span><span style=display:flex><span>rye publish 
</span></span></code></pre></div><h3 id=overview>Overview</h3><table><thead><tr><th></th><th><code>flit</code></th><th><code>poetry</code></th><th><code>pdm</code></th><th><code>hatch</code></th><th><code>rye</code></th></tr></thead><tbody><tr><td>Manages dependencies</td><td>❌</td><td>✅</td><td>✅</td><td>❌</td><td>✅</td></tr><tr><td>Resolves/locks dependencies</td><td>❌</td><td>✅</td><td>✅</td><td>❌</td><td>✅</td></tr><tr><td>Clean build/publish flow</td><td>✅</td><td>✅</td><td>✅</td><td>✅</td><td>✅</td></tr><tr><td>Supports plugins</td><td>❌</td><td>✅</td><td>✅</td><td>✅</td><td>❌</td></tr><tr><td>PEP 660 (editable installs)</td><td>✅</td><td>✅</td><td>✅</td><td>✅</td><td>✅</td></tr><tr><td>PEP 621 (project metadata)</td><td>✅</td><td>❌</td><td>✅</td><td>✅</td><td>✅</td></tr></tbody></table></div><div class=btn-improve-page><a href=https://github.com/zotroneneis/zotroneneis.github.io/edit/main/content/posts/python/packaging_tools.md><i class="fas fa-code-branch"></i>
Improve this page</a></div><hr><div class="row next-prev-navigator"><div class="col-md-12 next-article"><a href=/posts/machine_learning/principal_component_analysis/ class="btn btn-outline-info"><span>Next <i class="fas fa-chevron-circle-right"></i></span><br><span>Principal component analysis (PCA)</span></a></div></div><hr></div></div></div></section><section class=toc-section id=toc-section><div class=toc-holder><h5 class="text-center pl-3">Table of Contents</h5><hr><div class=toc><nav id=TableOfContents><ul><li><a href=#motivation>Motivation</a></li><li><a href=#categorization>Categorization</a></li><li><a href=#python-version-managment>Python version managment</a><ul><li><a href=#definition>Definition</a></li><li><a href=#motivation-1>Motivation</a></li><li><a href=#tools>Tools</a><ul><li><a href=#pyenv>pyenv</a></li></ul></li></ul></li><li><a href=#virtual-environment-management>(Virtual) environment management</a><ul><li><a href=#definition-1>Definition</a></li><li><a href=#motivation-2>Motivation</a></li><li><a href=#tools-1>Tools</a></li><li><a href=#venv>venv</a></li><li><a href=#virtualenv>virtualenv</a></li></ul></li><li><a href=#recap-i---pyprojecttoml>Recap I - <code>pyproject.toml</code></a></li><li><a href=#package-management>Package management</a><ul><li><a href=#definition-2>Definition</a></li><li><a href=#motivation-3>Motivation</a></li><li><a href=#tools-2>Tools</a><ul><li><a href=#pip>pip</a></li></ul></li></ul></li><li><a href=#recap-ii---lock-file>Recap II - lock file</a></li><li><a href=#multi-purpose-tools>Multi-purpose tools</a><ul><li><a href=#pipenv>Pipenv</a></li><li><a href=#conda>Conda</a></li><li><a href=#feature-evaluation>Feature evaluation</a></li><li><a href=#flit>Flit</a><ul><li><a href=#flit---capabilities>Flit - Capabilities</a></li><li><a href=#flit---feature-evaluation>Flit - Feature evaluation</a></li><li><a href=#flit---main-commands>Flit - Main commands</a></li></ul></li><li><a href=#poetry>Poetry</a><ul><li><a href=#poetry---capabilities>Poetry - Capabilities</a></li><li><a href=#poetry---feature-evaluation>Poetry - Feature evaluation</a></li><li><a href=#poetry---main-commands>Poetry - Main commands</a></li><li><a href=#poetry---dependency-management>Poetry - Dependency management</a></li><li><a href=#poetry---running-code>Poetry - Running code</a></li><li><a href=#poetry---lock-file>Poetry - Lock file</a></li></ul></li></ul></li><li><a href=#poetry---buildpublish-flow>Poetry - Build/publish flow</a><ul><li><a href=#pdm>PDM</a><ul><li><a href=#pdm---capabilities>PDM - Capabilities</a></li><li><a href=#pdm---feature-evaluation>PDM - Feature evaluation</a></li><li><a href=#pdm---main-commands>PDM - Main commands</a></li><li><a href=#pdm---dependency-management>PDM - Dependency management</a></li><li><a href=#pdm---running-code>PDM - Running code</a></li><li><a href=#pdm---lock-file>PDM - Lock file</a></li><li><a href=#buildpublish-flow>Build/publish flow</a></li></ul></li><li><a href=#hatch>Hatch</a><ul><li><a href=#hatch---capabilities>Hatch - Capabilities</a></li><li><a href=#hatch---feature-evaluation>Hatch - Feature evaluation</a></li><li><a href=#hatch---creating-a-new-project>Hatch - Creating a new project</a></li><li><a href=#hatch---dependency-management>Hatch - Dependency management</a></li><li><a href=#hatch---running-code>Hatch - Running code</a></li><li><a href=#hatch---buildpublish-flow>Hatch - Build/publish flow</a></li><li><a href=#hatch---declarative-environment-management>Hatch - Declarative environment management</a></li></ul></li><li><a href=#rye>Rye</a><ul><li><a href=#rye---capabilities>Rye - Capabilities</a></li><li><a href=#rye-1>Rye</a></li><li><a href=#rye---feature-evaluation>Rye - Feature evaluation</a></li><li><a href=#rye---creating-a-new-project>Rye - Creating a new project</a></li><li><a href=#rye---dependency-management>Rye - Dependency management</a></li><li><a href=#rye---running-code>Rye - Running code</a></li><li><a href=#rye---buildpublish-flow>Rye - Build/publish flow</a></li></ul></li><li><a href=#overview>Overview</a></li></ul></li></ul></nav></div></div></section></div><footer class="container-fluid text-center align-content-center footer pb-2"><div class="container pt-5"><div class="row text-left"><div class="col-md-4 col-sm-12"><h5>Navigation</h5><ul><li class=nav-item><a class=smooth-scroll href=#about>About</a></li><li class=nav-item><a class=smooth-scroll href=#skills>Skills</a></li><li class=nav-item><a class=smooth-scroll href=#experiences>Experiences</a></li><li class=nav-item><a class=smooth-scroll href=#education>Education</a></li><li class=nav-item><a class=smooth-scroll href=#projects>Projects</a></li><li class=nav-item><a class=smooth-scroll href=#recent-posts>Recent Posts</a></li><li class=nav-item><a class=smooth-scroll href=#appearances>Talks & Podcasts</a></li></ul></div><div class="col-md-4 col-sm-12"><h5>Contact me:</h5><ul><li><span>Email:</span> <span>popkes@gmx.net</span></li></ul></div></div></div><hr><div class=container><div class="row text-left"><div class=col-md-4><a id=theme href=https://github.com/hossainemruz/toha target=#><img src=/images/theme-logo_hu8376fd15465fef26ffe66b6bcf0ca686_13669_32x0_resize_box_3.png>
Toha</a></div><div class="col-md-4 text-center">© 2020-2021 Copyright.</div><div class="col-md-4 text-right"><a id=hugo href=https://gohugo.io/>Powered by
<img src=/images/hugo-logo.svg alt="Hugo Logo" height=18></a></div></div></div></footer><script src=/js/jquery-3.4.1.min.js></script>
<script src=/js/popper.min.js></script>
<script src=/js/bootstrap.min.js></script>
<script src=/js/navbar.js></script>
<script src=/js/main.js></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/highlight.min.js></script>
<script src=/js/single.js></script>
<script>hljs.initHighlightingOnLoad()</script></body></html>